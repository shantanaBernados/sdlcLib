libApp.factory("ConfigService",function(){return{getBEService:function(a){return"http://10.192.21.13/FPTLibrary/"+a}}}),libApp.controller("MainCtrl",["$q","$scope","$filter","uiGridConstants","MainService",function(a,b,c,d,e){b.yeah="chincha";var f=[];b.searchText="",b.bookModel={},b.selectedBooks=[],b.noData={message:"No Record Found"},b.gridOptions={enableSorting:!0,enableColumnMenus:!1,enablColumnResizing:!0,paginationPageSizes:[10,15,25,50],paginationPageSize:10,onRegisterApi:function(a){b.gridApi=a},columnDefs:[{field:"IsbnCode",displayName:"ISBN Code",cellTemplate:'<div class="ui-grid-cell-contents"><button class="btn-link" ng-click="grid.appScope.viewBook(row.entity)" data-toggle="modal" data-target="#bookDetailsModal">{{row.entity.IsbnCode}}</button></div>'},{field:"Title"},{field:"AuthorName",displayName:"Author Name"},{field:"YearPublish",displayName:"Year Published"},{field:"CategoryName",displayName:"Category"}]},b.getCategories=function(){e.getAllCategories().then(function(a){b.categories=a},function(a){b.status={status:"error",message:a.data.Message}})},b.getBooks=function(){b.noData.message="Loading...",e.getAllBooks().then(function(a){f=a,b.gridOptions.data=a,b.noData.message="No Record Found"},function(a){b.status={status:"error",message:a.data.Message},b.noData.message="No Record Found"})},b.addBook=function(){b.bookModel.CategoryName=c("filter")(b.categories,{Id:b.bookModel.CategoryId})[0].Name,e.addBook(b.bookModel).then(function(a){b.status=a,b.getBooks()},function(a){b.status={status:"error",message:a.data.Message}})},b.editBook=function(){e.editBook(b.bookModel).then(function(a){b.status=a,b.getBooks()},function(a){b.status={status:"error",message:a.data.Message}})},b.deleteBooks=function(){var c=[];b.gridApi.selection.getSelectedRows().forEach(function(a){c.push(e.deleteBook(a.IsbnCode))}),a.all(c).then(function(a){b.status={status:"success",message:"Successfully deleted all selected books"},b.getBooks()},function(a){b.status={status:"error",message:a.data.Message}})},b.search=function(){b.gridOptions.data=c("filter")(f,b.searchText)},b.viewBook=function(a){b.bookModel=a},b.submitBookForm=function(){"add"==b.action?b.addBook():"edit"==b.action&&b.editBook(),$("#bookModal").modal("hide")},b.reAssignModel=function(){b.bookModel=$.extend(!0,{},b.origModel),"add"==b.action&&b.resetForm()},b.resetStatus=function(){b.status={}},b.resetForm=function(){document.getElementById("bookForm").reset()};var g=function(){b.bookModel={},b.bookForm.$setPristine(),b.validate=!1,"add"==b.action&&b.resetForm(),$("#categories").prop("selectedIndex",0)};$("#bookModal").on("hide.bs.modal",g),b.getCategories(),b.getBooks()}]),libApp.factory("MainService",["$http","ConfigService",function(a,b){return{getAllBooks:function(){return a.get(b.getBEService("Books")).then(function(a){return a.data})},addBook:function(c){return a.post(b.getBEService("Books"),c).then(function(a){return{status:"success",message:a.data.Title+" succesfully added"}})},deleteBook:function(c){return a.delete(b.getBEService("Books/"+c)).then(function(a){return{status:"success",message:a.data.Title+" succesfully deleted"}})},editBook:function(c){return a.put(b.getBEService("Books"),c).then(function(a){return{status:"success",message:c.Title+" succesfully edited"}})},getAllCategories:function(){return a.get(b.getBEService("Categories")).then(function(a){return a.data})}}}]);